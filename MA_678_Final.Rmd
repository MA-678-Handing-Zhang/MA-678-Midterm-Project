---
title: "MA 678 Final Project"
author: "Handing Zhang"
date: "12/7/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

library(readr)
library(tidyverse)
library(stringr)
library(rstanarm)
library(knitr)
library(magrittr)
library(kableExtra)
library(gridExtra)
library(tidytext)
library(lubridate)
library(car) 
library(gvlma)
library(lme4)
library(arm)
library(lmerTest)

```




## Abstract (a paragraph): high-level summary of your work.

Research Question: factors that contribute to the number of likes.
Categories: Categories of video
fixed effects: video_age, duration_sec, view_count, dislike_count, caption, number of comments

## Introduction: Background and other information necessary to understand your work.

introduce the dataset

## Method: What you did in some detail.



### Data Cleaning

The dataset I use is published on Kaggle:
name: ***BBC YouTube Videos Metadata***
link: https://www.kaggle.com/gpreda/bbc-youtube-videos-metadata






| column names      | explanation |
| :--:              | :----- |
| video_title             | The title of the video|
| video_age          | number of days from date of publish to 2021-12-07 |
| video_category_label         | The category of the video |
| duration_sec     | How long is the  video in  seconds |
| view_count          | The number of views |
| like_count        | The number of likes of the video|
| dislike_count           | The number of dislikes of the video|
| caption           | Boolean value indicating whether or not there is caption|
| comment_count           | number of comments|



```{r}
# read in the data.
bbc <- read_csv("bbc.csv")

bbc %<>% 
  dplyr::select(published_at, video_title, video_category_label,
         duration_sec, caption, view_count, like_count, dislike_count, comment_count)

bbc$published_at <- as_date(bbc$published_at)

bbc %<>% 
  mutate(video_age = as_date("2021-12-07") - published_at) %>% 
  dplyr::select(-published_at)# calculate age for each video

bbc$video_age <- as.numeric(bbc$video_age)

bbc %<>%
  mutate(log_comment = log(comment_count),
         log_view = log(view_count),
         log_like = log(like_count),
         log_age = log(video_age),
         )
# drop NA
bbc %<>% 
  drop_na()

# drop Inf
bbc %<>%
  filter(log_comment != -Inf)

```

### EDA


```{r echo=FALSE, fig.height=4, fig.width= 10,fig.cap="Data was separate into English talks and not English talks. Different colors represent different categories.talke log of both comments and views to make it more easy to read."}
ggplot(data = bbc)+
  aes(log(view_count),log(like_count)) +
  geom_point(aes(color = video_category_label), alpha = 0.3)+
  labs(title="number of views vs like count",x="log(number of views)",y="log(like count)")+
  geom_smooth(aes(color =  video_category_label),method = "lm",se=F)+
  facet_wrap(~video_category_label)
```

```{r}
ggplot(data = bbc)+
  aes(log(video_age),log(like_count)) +
  geom_point(aes(color = video_category_label), alpha = 0.3)+
  labs(title="video age vs like count",x="log(video age)",y="log(like count)")+
  geom_smooth(aes(color =  video_category_label),method = "lm",se=F)+
  facet_wrap(~video_category_label)

```



```{r comment_count}

ggplot(data = bbc) +
  aes(log(comment_count), log(like_count)) +
  geom_point(aes(color = video_category_label), alpha = 0.3)+
  labs(title="comment count vs like count",x="log(comment count)",y="log(like count)")+
  geom_smooth(aes(color =  video_category_label),method = "lm", se=F) # +
  # facet_wrap(~video_category_label)

```


```{r caption}

ggplot(data = bbc)+
  aes(caption, log(like_count)) +
  geom_point(aes(color = video_category_label), alpha = 0.3)+
  labs(title="comment count vs like count",x="log(comment count)",y="log(like count)")+
  geom_smooth(aes(color =  video_category_label),method = "lm", se=F) # +
  # facet_wrap(~video_category_label)

```


### Model Fitting


```{r}


# fit_bbc <- lmer(log_like ~ log_comment + log_age + log_view + (1 + log_comment|video_category_label) + (1 + log_age|video_category_label)+(1+log_view|video_category_label), data = bbc)


fit_bbc <- lmer(log_like ~ log_comment + log_age + log_view + (1|video_category_label), data = bbc)
summary(fit_bbc)
coef(fit_bbc)


```



## Result: What you found.



## Discussion: What you think this means and what are the next steps.


## Citation


```{r}




```


```{r}



```


```{r}
```


```{r}
```


```{r}
```


```{r}
```





